name: Critical CSS - Webhook

on:
  workflow_dispatch:
  repository_dispatch:
    types:
      - critical-css

jobs:
  print-instructions:
    runs-on: ubuntu-latest
    if: github.event_name == 'workflow_dispatch'
    steps:
        - run: |
            message="You ran the webhook via the workflow-dispatch, but it is meant to be called via webhook.
            So let me tell you how to do that: \n
            You will need to create a PAT (new) with write access to this repos Contents.
            Then use cURL to trigger the webhook like this:
            curl -X POST https://api.github.com/repos/${{ github.repository }}/dispatches \
               -H 'Accept: application/vnd.github+json' \
                -H 'Authorization:${{ 'Bearer' }} <${{ 'YOUR PAT' }} GOES HERE>' \
                -d '{\"event_type\": \"critical-css\"}'"
            
            echo -e "$message"
            echo -e "$message" >> $GITHUB_OUTPUT


  build-critical-css:
    runs-on: ubuntu-latest
    steps:
      - run: echo "Building critical css after receiving the webhook from argo"